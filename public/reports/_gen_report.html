<pre>
Feature: Get Fields with and without view



  <strong>> Scenario</strong>: Fields bookmark with NO view parameter                                                                           # cucumber/features/fields.feature:20
    Given the client is authorized                                                                                           # cucumber/features/fields.feature:21
Fetching /bookmarks/fields
    When the client requests the "fields" bookmark without view parameter                                                    # cucumber/features/fields.feature:22
      <span style='color:#FF0000'><strong>Error</strong></span>: connect ECONNREFUSED

    Then the response contains
      | ATTRIBUTE | DESCRIPTION     |
      | fields    | Array of fields |
    And the "fields" attribute contains 1 or more item                                                                       # cucumber/features/fields.feature:26
    And each key in "fields" has a valid resource with just the following information when requested without view parameter: # cucumber/features/fields.feature:27
      | ATTRIBUTE | DESCRIPTION               |
      | boundary  | bounding coordinates      |
      | name      | human-readable field name |
      | crop      |                           |


  <strong>> Scenario</strong>: Fields bookmark WITH view parameter                                              # cucumber/features/fields.feature:33
    Given the client is authorized                                                           # cucumber/features/fields.feature:34
Fetching /bookmarks/fields?view=%7B%22%24each%22%3A%7B%22%24expand%22%3Atrue%7D%7D
    When the client requests the "fields" bookmark with view parameter                       # cucumber/features/fields.feature:35
      <span style='color:#FF0000'><strong>Error</strong></span>: connect ECONNREFUSED

    And the "fields" attribute contains 1 or more item                                       # cucumber/features/fields.feature:36
    And each item in "fields" has
      | ATTRIBUTE | DESCRIPTION               |
      | _id       | id of the field resources |
      | boundary  | bounding coordinates      |
      | name      | human-readable field name |
      | crop      |                           |
    And the "boundary" of each item in "fields" contains
      | ATTRIBUTE   | DESCRIPTION |
      | coordinates |             |
      | type        |             |


Feature: Get harvesters bookmark



  <strong>> Scenario</strong>: Go to harvesters bookmarks endpoint with no view parameter                 # cucumber/features/harvesters.feature:3
    Given the client is authorized                                                     # cucumber/features/harvesters.feature:6
Fetching /bookmarks/machines/harvesters
    When the client requests the "machines/harvesters" bookmark without view parameter # cucumber/features/harvesters.feature:7
      <span style='color:#FF0000'><strong>Error</strong></span>: connect ECONNREFUSED

    Then each item has just the following information:                                 # cucumber/features/harvesters.feature:8
      | ATTRIBUTE | DESCRIPTION               |
      | _id       | id of the field resources |


  <strong>> Scenario</strong>: Go to the harvesters bookmarks endpoint                    # cucumber/features/harvesters.feature:12
    Given the client is authorized                                     # cucumber/features/harvesters.feature:15
Fetching /bookmarks/machines/harvesters
    When the client requests for the harvester with identifier "4727"  # cucumber/features/harvesters.feature:16
      <span style='color:#FF0000'><strong>Error</strong></span>: connect ECONNREFUSED

    Then the response contains
      | ATTRIBUTE     | DESCRIPTION                  |
      | serial_number | Serial number of the vehicle |
      | model_year    | Model Year                   |
      | model         | Model Name                   |
      | name          | Name of the harvester        |
      | streams       | Stream of useful data        |
    And the response is a "configuration"                              # cucumber/features/harvesters.feature:24
    And each item in "streams" has
      | ATTRIBUTE | DESCRIPTION         |
      | _id       | link to data stream |


Feature: Get resources WITH various view parameters



  <strong>> Scenario</strong>: Get the MOISTURE stream with filtering changeId > 0, changeId > max -1                          # cucumber/features/resources_with_view.feature:2
    Given the client is authorized                                                                          # cucumber/features/resources_with_view.feature:3
    When the client requests a "moisture" stream for harvester with identifier "4727" with view parameter A # cucumber/features/resources_with_view.feature:4
      <span style='color:#FF0000'><strong>Error</strong></span>: connect ECONNREFUSED

    Then the response contains
      | ATTRIBUTE | DESCRIPTION |
      | units     |             |
      | moistures |             |
    And the "moistures" attribute contains 1 or more item                                                   # cucumber/features/resources_with_view.feature:9
    And each item in "moistures" has
      | ATTRIBUTE |
      | _meta     |
      | moisture  |
      | t         |
    And the "_meta" of each item in "moistures" contains
      | ATTRIBUTE | DESCRIPTION                  |
      | _changeId | What revision are these data |
    And remember the maximum value of "$.*._meta._changeId" for every items in "moistures"                  # cucumber/features/resources_with_view.feature:18
    And check the "moisture" stream again, this time with view parameter MAXCHG                             # cucumber/features/resources_with_view.feature:19
    And all values of "$.moistures.*._meta._changeId" are equals to the previously remembered value         # cucumber/features/resources_with_view.feature:20


  <strong>> Scenario</strong>: Get the LOCATION stream with filtering changeId > 0, changeId > max -1                          # cucumber/features/resources_with_view.feature:22
    Given the client is authorized                                                                          # cucumber/features/resources_with_view.feature:23
    When the client requests a "location" stream for harvester with identifier "4727" with view parameter A # cucumber/features/resources_with_view.feature:24
      <span style='color:#FF0000'><strong>Error</strong></span>: connect ECONNREFUSED

    And the response contains
      | ATTRIBUTE         | DESCRIPTION            |
      | coordinate_system | what coordinate system |
      | locations         | action data array      |
    And the "locations" attribute contains 1 or more item                                                   # cucumber/features/resources_with_view.feature:29
    And each item in "locations" has
      | ATTRIBUTE |
      | _meta     |
      | t         |
      | lat       |
      | lon       |
      | alt       |
    And the "_meta" of each item in "locations" contains
      | ATTRIBUTE | DESCRIPTION                  |
      | _changeId | What revision are these data |
    And remember the maximum value of "$.*._meta._changeId" for every items in "locations"                  # cucumber/features/resources_with_view.feature:40
    And check the "locations" stream again, this time with view parameter MAXCHG                            # cucumber/features/resources_with_view.feature:41
    And all values of "$.locations.*._meta._changeId" are equals to the previously remembered value         # cucumber/features/resources_with_view.feature:42


  <strong>> Scenario</strong>: Get the SWATH WIDTH stream with filtering changeId > 0, changeId > max -1                          # cucumber/features/resources_with_view.feature:44
    Given the client is authorized                                                                             # cucumber/features/resources_with_view.feature:45
    When the client requests a "swath_width" stream for harvester with identifier "4727" with view parameter A # cucumber/features/resources_with_view.feature:46
      <span style='color:#FF0000'><strong>Error</strong></span>: connect ECONNREFUSED

    And the response contains
      | ATTRIBUTE | DESCRIPTION  |
      | units     | unit stream  |
      | widths    | width stream |
    And the "widths" attribute contains 1 or more item                                                         # cucumber/features/resources_with_view.feature:51
    And each item in "widths" has
      | ATTRIBUTE | DESCRIPTION |
      | _meta     | meta        |
      | t         | timestamp   |
      | width     | width       |
    And the "_meta" of each item in "widths" contains
      | ATTRIBUTE | DESCRIPTION                  |
      | _changeId | What revision are these data |
    And remember the maximum value of "$.*._meta._changeId" for every items in "widths"                        # cucumber/features/resources_with_view.feature:60
    And check the "widths" stream again, this time with view parameter MAXCHG                                  # cucumber/features/resources_with_view.feature:61
    And all values of "$.widths.*._meta._changeId" are equals to the previously remembered value               # cucumber/features/resources_with_view.feature:62


  <strong>> Scenario</strong>: Get the WORK STATUS stream with filtering changeId > 0, changeId > max -1                          # cucumber/features/resources_with_view.feature:65
    Given the client is authorized                                                                             # cucumber/features/resources_with_view.feature:66
    When the client requests a "work_status" stream for harvester with identifier "4727" with view parameter A # cucumber/features/resources_with_view.feature:67
      <span style='color:#FF0000'><strong>Error</strong></span>: connect ECONNREFUSED

    And the response contains
      | ATTRIBUTE | DESCRIPTION |
      | status    | Array       |
    And the "status" attribute contains 1 or more item                                                         # cucumber/features/resources_with_view.feature:71
    And each item in "status" has
      | ATTRIBUTE |
      | _meta     |
      | t         |
      | case      |
    And the "_meta" of each item in "status" contains
      | ATTRIBUTE | DESCRIPTION                  |
      | _changeId | What revision are these data |
    And remember the maximum value of "$.*._meta._changeId" for every items in "status"                        # cucumber/features/resources_with_view.feature:80
    And check the "work_status" stream again, this time with view parameter MAXCHG                             # cucumber/features/resources_with_view.feature:81
    And all values of "$.status.*._meta._changeId" are equals to the previously remembered value               # cucumber/features/resources_with_view.feature:82


  <strong>> Scenario</strong>: Get geofence stream (1241) and verify that the data make sense                                  # cucumber/features/resources_with_view.feature:86
    Given the client is authorized                                                                          # cucumber/features/resources_with_view.feature:89
    When the client requests a "geofence" stream for harvester with identifier "4727" with view parameter 1 # cucumber/features/resources_with_view.feature:90
      <span style='color:#FF0000'><strong>Error</strong></span>: Cannot find module '../support/view_parameters/1.json'

    And the "events" attribute contains 1 or more item                                                      # cucumber/features/resources_with_view.feature:91
    And the 1st event for any particular field in this sorted array is an "enter" event                     # cucumber/features/resources_with_view.feature:92
    And the 2nd event (if any exit) for a particular field is an "exit" event                               # cucumber/features/resources_with_view.feature:93
    And there are no subsequent enter events for a particular field before exiting that field               # cucumber/features/resources_with_view.feature:94
    And there are no subsequent exit events for a particular field before entering that field               # cucumber/features/resources_with_view.feature:95
    And each item in "events" has
      | ATTRIBUTE | DESCRIPTION         |
      | t         | timestamp of stream |
      | field     | field information   |
    And the "field" of each item in "events" contains
      | ATTRIBUTE | DESCRIPTION                      |
      | _id       | ..                               |
      | name      | human-readable name of the field |


Feature: Get resources with NO view parameters



  <strong>> Scenario</strong>: Get geofence stream without view                                                                   # cucumber/features/resources_without_view.feature:3
    Given the client is authorized                                                                             # cucumber/features/resources_without_view.feature:6
    When the client requests a "geofence" stream for harvester with identifier "4727" without view parameter A # cucumber/features/resources_without_view.feature:7
      <span style='color:#FF0000'><strong>Error</strong></span>: connect ECONNREFUSED

    And the "events" attribute contains 1 or more item                                                         # cucumber/features/resources_without_view.feature:8
    And each item in "events" has
      | ATTRIBUTE | DESCRIPTION         |
      | t         | timestamp of stream |
      | field     | field information   |
    And the "field" of each item in "events" contains
      | ATTRIBUTE | DESCRIPTION                      |
      | _id       | ..                               |
      | name      | human-readable name of the field |


  <strong>> Scenario</strong>: Get location stream without view                                                                   # cucumber/features/resources_without_view.feature:18
    Given the client is authorized                                                                             # cucumber/features/resources_without_view.feature:19
    When the client requests a "location" stream for harvester with identifier "4727" without view parameter A # cucumber/features/resources_without_view.feature:20
      <span style='color:#FF0000'><strong>Error</strong></span>: connect ECONNREFUSED

    And the response contains
      | ATTRIBUTE         | DESCRIPTION            |
      | coordinate_system | what coordinate system |
      | locations         | action data array      |
    And the "locations" attribute contains 1 or more item                                                      # cucumber/features/resources_without_view.feature:25
    And each item in "locations" has
      | ATTRIBUTE |
      | _id       |
      | t         |
      | lat       |
      | lon       |
      | alt       |


  <strong>> Scenario</strong>: Get swath width stream without view                                                                   # cucumber/features/resources_without_view.feature:34
    Given the client is authorized                                                                                # cucumber/features/resources_without_view.feature:35
    When the client requests a "swath_width" stream for harvester with identifier "4727" without view parameter A # cucumber/features/resources_without_view.feature:36
      <span style='color:#FF0000'><strong>Error</strong></span>: connect ECONNREFUSED

    And the response contains
      | ATTRIBUTE | DESCRIPTION  |
      | units     | unit stream  |
      | widths    | width stream |
    And the "widths" attribute contains 1 or more item                                                            # cucumber/features/resources_without_view.feature:41
    And each item in "widths" has
      | ATTRIBUTE | DESCRIPTION |
      | _id       | id          |
      | t         | timestamp   |
      | width     | width       |


  <strong>> Scenario</strong>: Get work status stream without view                                                                   # cucumber/features/resources_without_view.feature:48
    Given the client is authorized                                                                                # cucumber/features/resources_without_view.feature:49
    When the client requests a "work_status" stream for harvester with identifier "4727" without view parameter A # cucumber/features/resources_without_view.feature:50
      <span style='color:#FF0000'><strong>Error</strong></span>: connect ECONNREFUSED

    And the "status" attribute contains 1 or more item                                                            # cucumber/features/resources_without_view.feature:51
    And the response contains
      | ATTRIBUTE | DESCRIPTION |
      | status    | Array       |
    And each item in "status" has
      | ATTRIBUTE |
      | _id       |
      | t         |
      | case      |


  <strong>> Scenario</strong>: Get wet_mass_flow stream without view                                                                   # cucumber/features/resources_without_view.feature:61
    Given the client is authorized                                                                                  # cucumber/features/resources_without_view.feature:62
    When the client requests a "wet_mass_flow" stream for harvester with identifier "4727" without view parameter A # cucumber/features/resources_without_view.feature:63
      <span style='color:#FF0000'><strong>Error</strong></span>: connect ECONNREFUSED

    And the response contains
      | ATTRIBUTE | DESCRIPTION |
      | units     |             |
      | flows     |             |
    And each item in "flows" has
      | ATTRIBUTE |
      | _id       |
      | t         |
      | flow      |


  <strong>> Scenario</strong>: Get the moisture stream without view                                                               # cucumber/features/resources_without_view.feature:74
    Given the client is authorized                                                                             # cucumber/features/resources_without_view.feature:75
    When the client requests a "moisture" stream for harvester with identifier "4727" without view parameter A # cucumber/features/resources_without_view.feature:76
      <span style='color:#FF0000'><strong>Error</strong></span>: connect ECONNREFUSED

    And the response contains
      | ATTRIBUTE | DESCRIPTION |
      | units     |             |
      | moistures |             |
    And each item in "moistures" has
      | ATTRIBUTE |
      | _id       |
      | moisture  |
      | t         |


(::) <span style='color:#FF0000'><strong>failed</strong></span> steps (::)

<span style='color:#FF0000'><strong>Error</strong></span>: connect ECONNREFUSED


<span style='color:#FF0000'><strong>Error</strong></span>: connect ECONNREFUSED


<span style='color:#FF0000'><strong>Error</strong></span>: connect ECONNREFUSED


<span style='color:#FF0000'><strong>Error</strong></span>: connect ECONNREFUSED


<span style='color:#FF0000'><strong>Error</strong></span>: connect ECONNREFUSED


<span style='color:#FF0000'><strong>Error</strong></span>: connect ECONNREFUSED


<span style='color:#FF0000'><strong>Error</strong></span>: connect ECONNREFUSED


<span style='color:#FF0000'><strong>Error</strong></span>: connect ECONNREFUSED


<span style='color:#FF0000'><strong>Error</strong></span>: Cannot find module '../support/view_parameters/1.json'


<span style='color:#FF0000'><strong>Error</strong></span>: connect ECONNREFUSED


<span style='color:#FF0000'><strong>Error</strong></span>: connect ECONNREFUSED


<span style='color:#FF0000'><strong>Error</strong></span>: connect ECONNREFUSED


<span style='color:#FF0000'><strong>Error</strong></span>: connect ECONNREFUSED


<span style='color:#FF0000'><strong>Error</strong></span>: connect ECONNREFUSED


<span style='color:#FF0000'><strong>Error</strong></span>: connect ECONNREFUSED


<span style='color:#FF0000'><strong>Failing scenarios</strong></span>:
/Users/ssabpisa/oada-test/cucumber/features/fields.feature:20 # <strong>> Scenario</strong>: Fields bookmark with NO view parameter
/Users/ssabpisa/oada-test/cucumber/features/fields.feature:33 # <strong>> Scenario</strong>: Fields bookmark WITH view parameter
/Users/ssabpisa/oada-test/cucumber/features/harvesters.feature:3 # <strong>> Scenario</strong>: Go to harvesters bookmarks endpoint with no view parameter
/Users/ssabpisa/oada-test/cucumber/features/harvesters.feature:12 # <strong>> Scenario</strong>: Go to the harvesters bookmarks endpoint
/Users/ssabpisa/oada-test/cucumber/features/resources_with_view.feature:2 # <strong>> Scenario</strong>: Get the MOISTURE stream with filtering changeId > 0, changeId > max -1
/Users/ssabpisa/oada-test/cucumber/features/resources_with_view.feature:22 # <strong>> Scenario</strong>: Get the LOCATION stream with filtering changeId > 0, changeId > max -1
/Users/ssabpisa/oada-test/cucumber/features/resources_with_view.feature:44 # <strong>> Scenario</strong>: Get the SWATH WIDTH stream with filtering changeId > 0, changeId > max -1
/Users/ssabpisa/oada-test/cucumber/features/resources_with_view.feature:65 # <strong>> Scenario</strong>: Get the WORK STATUS stream with filtering changeId > 0, changeId > max -1
/Users/ssabpisa/oada-test/cucumber/features/resources_with_view.feature:86 # <strong>> Scenario</strong>: Get geofence stream (1241) and verify that the data make sense
/Users/ssabpisa/oada-test/cucumber/features/resources_without_view.feature:3 # <strong>> Scenario</strong>: Get geofence stream without view
/Users/ssabpisa/oada-test/cucumber/features/resources_without_view.feature:18 # <strong>> Scenario</strong>: Get location stream without view
/Users/ssabpisa/oada-test/cucumber/features/resources_without_view.feature:34 # <strong>> Scenario</strong>: Get swath width stream without view
/Users/ssabpisa/oada-test/cucumber/features/resources_without_view.feature:48 # <strong>> Scenario</strong>: Get work status stream without view
/Users/ssabpisa/oada-test/cucumber/features/resources_without_view.feature:61 # <strong>> Scenario</strong>: Get wet_mass_flow stream without view
/Users/ssabpisa/oada-test/cucumber/features/resources_without_view.feature:74 # <strong>> Scenario</strong>: Get the moisture stream without view

15 scenarios (15 <span style='color:#FF0000'><strong>failed</strong></span>)
91 steps (15 <span style='color:#FF0000'><strong>failed</strong></span>, 4 undefined, 57 skipped, 15 <span style='color:#1BAE1C'><strong>passed</strong></span>)

You can implement step definitions for undefined steps with these snippets:

this.When(/^the (\d+)st event for any particular field in this sorted array is an "([^"]*)" event$/, function (arg1, arg2, callback) {
  // Write code here that turns the phrase above into concrete actions
  callback.pending();
});

this.When(/^the (\d+)nd event \(if any exit\) for a particular field is an "([^"]*)" event$/, function (arg1, arg2, callback) {
  // Write code here that turns the phrase above into concrete actions
  callback.pending();
});

this.When(/^there are no subsequent enter events for a particular field before exiting that field$/, function (callback) {
  // Write code here that turns the phrase above into concrete actions
  callback.pending();
});

this.When(/^there are no subsequent exit events for a particular field before entering that field$/, function (callback) {
  // Write code here that turns the phrase above into concrete actions
  callback.pending();
});

</pre>